(this["webpackJsonp1tronic-frontend"]=this["webpackJsonp1tronic-frontend"]||[]).push([[9],{1177:function(e,t,n){var c=n(477),a=n(478),r=n(231),s=n(85),o=n(173),i=n(298),l=n(300),b=n(299),d=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(o(e)&&(s(e)||"string"==typeof e||"function"==typeof e.splice||i(e)||b(e)||r(e)))return!e.length;var t=a(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(l(e))return!c(e).length;for(var n in e)if(d.call(e,n))return!1;return!0}},1477:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n(3),r=n(57),s=n(29),o=n(820),i=n.n(o),l=n(1177),b=n.n(l),d=n(139),j=n(50),u=n(82),x=n(23),h=n(30),p=n(794),m=n(181),O=n(10),f=n(228),g=n(430),y=n(102),v=n(909),w=n(853),k=n(781),T=n(865),B=n(4),C=n(0);const S=B.e.label`
  color: ${e=>{let{theme:t}=e;return t.colors.text}};
  display: block;
  font-weight: 600;
  margin-bottom: 8px;
`,V=Object(B.e)(S)`
  font-size: 20px;
`,D=Object(B.e)(S)`
  font-size: 12px;
  text-transform: uppercase;
`,P=e=>{let{children:t}=e;return Object(C.jsx)(a.Vb,{color:"failure",mb:"4px",children:t})},A=e=>{let{errors:t}=e;return Object(C.jsx)(a.m,{mt:"8px",children:t.map((e=>Object(C.jsx)(P,{children:e},e)))})};var E=n(123),I=n.n(E);var z=e=>{let{onRemove:t,onTextInput:n,...r}=e;const[s,o]=Object(c.useState)(!1),[i,l]=Object(c.useState)(!1);return Object(C.jsxs)(a.m,{position:"relative",mb:"16px",children:[Object(C.jsx)(a.bb,{...r,onChange:e=>{const{value:t}=e.currentTarget;o(i&&0===t.length),l(!0),n(t)},isWarning:s}),t&&Object(C.jsx)(a.m,{position:"absolute",right:"8px",top:"0px",zIndex:30,children:Object(C.jsx)(a.Y,{variant:"text",onClick:t,children:Object(C.jsx)(a.K,{})})})]})};const L=()=>({id:I()(),value:""});var Y=e=>{let{choices:t,onChange:n}=e;const{t:c}=Object(O.b)(),r=t.filter((e=>e.value.length>0)).length>=2;return Object(C.jsxs)(a.u,{children:[Object(C.jsx)(a.x,{children:Object(C.jsx)(a.V,{as:"h3",scale:"md",children:c("Choices")})}),Object(C.jsxs)(a.v,{children:[t.map(((e,a)=>{let{id:r,value:s}=e;return Object(C.jsx)(z,{scale:"lg",onTextInput:e=>{const c=[...t],a=c.findIndex((e=>e.id===r));c[a].value=e,n(c)},placeholder:c("Input choice text"),value:s,onRemove:a>1?()=>{n(t.filter((e=>e.id!==r)))}:void 0},r)})),Object(C.jsx)(a.q,{type:"button",onClick:()=>{n([...t,L()])},disabled:!r,children:c("Add Choice")})]})]})},M=n(334),$=n(753),F=n(729);const H=(e,t)=>{if(!Object(M.default)(e)||!Object(M.default)(t))return null;const n=Object($.default)(e,"yyyy-MM-dd"),c=Object($.default)(t,"HH:mm:ss");return Object(F.default)(`${n}T${c}`).getTime()/1e3};var N=n(783),q=n(93),K=n(867),J=n(866);var R=e=>{let{block:t,onDismiss:n}=e;const{t:r}=Object(O.b)(),[s,o]=Object(c.useState)(!0),{isLoading:i,total:l,cakeBalance:b,cakeVaultBalance:d,cakePoolBalance:j,poolsBalance:u,cakeBnbLpBalance:x}=Object(K.a)(t,s),{theme:h}=Object(q.a)();return Object(C.jsx)(a.rb,{title:r("Voting Power"),onDismiss:()=>{o(!1),n()},headerBackground:h.colors.gradients.cardHeader,children:Object(C.jsx)(a.m,{mb:"24px",width:"320px",children:i?Object(C.jsx)(a.T,{height:"450px",alignItems:"center",justifyContent:"center",children:Object(C.jsx)(a.Nb,{size:80})}):Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(J.a,{total:l,cakeBalance:b,cakeVaultBalance:d,cakePoolBalance:j,poolsBalance:u,cakeBnbLpBalance:x}),Object(C.jsx)(a.q,{variant:"secondary",onClick:n,width:"100%",mt:"16px",children:r("Close")})]})})})};const W=Object(c.lazy)((()=>Promise.all([n.e(5),n.e(19)]).then(n.bind(null,1464))));t.default=()=>{const[e,t]=Object(c.useState)({name:"",body:"",choices:i()(2).map(L),startDate:null,startTime:null,endDate:null,endTime:null,snapshot:0}),[n,o]=Object(c.useState)(!1),[l,B]=Object(c.useState)({}),{t:S}=Object(O.b)(),{account:P}=Object(s.c)(),E=Object(d.b)(),{push:I}=Object(r.g)(),{library:z}=Object(x.a)(),{toastSuccess:$,toastError:F}=Object(u.a)(),[q]=Object(a.rc)(Object(C.jsx)(R,{block:e.snapshot})),{name:K,body:J,choices:U,startDate:Q,startTime:_,endDate:G,endTime:X,snapshot:Z}=e,ee=((e,t)=>{const{name:n,body:c,choices:a,startDate:r,startTime:s,endDate:o,endTime:i,snapshot:l}=e,b={};n||(b.name=[t("%field% is required",{field:"Title"})]),c||(b.body=[t("%field% is required",{field:"Body"})]),a.length<2&&(b.choices=[t("Please create a minimum of %num% choices",{num:2})]);const d=a.some((e=>!e.value));2===a.length&&d&&(b.choices=Array.isArray(b.choices)?[...b.choices,t("Choices must not be empty")]:b.choices=[t("Choices must not be empty")]),Object(M.default)(r)||(b.startDate=[t("Please select a valid date")]),Object(M.default)(s)||(b.startTime=[t("Please select a valid time")]),Object(M.default)(o)||(b.endDate=[t("Please select a valid date")]),Object(M.default)(i)||(b.endTime=[t("Please select a valid time")]);const j=H(r,s);return H(o,i)<j&&(b.endDate=Array.isArray(b.endDate)?[...b.endDate,t("End date must be after the start date")]:b.endDate=[t("End date must be after the start date")]),0===l&&(b.snapshot=[t("Invalid snapshot")]),b})(e,S),te=(e,n)=>{t((t=>({...t,[e]:n}))),B((t=>({...t,[e]:!0})))},ne=e=>t=>{te(e,t)},ce=Object(c.useMemo)((()=>({hideIcons:P===N.a?[]:["guide","fullscreen","preview","side-by-side","image"]})),[P]);return Object(c.useEffect)((()=>{E>0&&t((e=>({...e,snapshot:E})))}),[E,t]),Object(C.jsxs)(f.a,{py:"40px",children:[Object(C.jsx)(a.m,{mb:"48px",children:Object(C.jsxs)(a.n,{children:[Object(C.jsx)(w.a,{to:"/",children:S("Home")}),Object(C.jsx)(w.a,{to:"/voting",children:S("Voting")}),Object(C.jsx)(a.Vb,{children:S("Make a Proposal")})]})}),Object(C.jsx)("form",{onSubmit:async e=>{e.preventDefault();try{o(!0);const e=JSON.stringify({...Object(k.e)(),type:j.f.PROPOSAL,payload:{name:K,body:J,snapshot:Z,start:H(Q,_),end:H(G,X),choices:U.filter((e=>e.value)).map((e=>e.value)),metadata:Object(k.d)(),type:"single-choice"}}),t=await Object(m.c)(z,P,e);if(t){const n={address:P,msg:e,sig:t},c=await Object(k.i)(n);I(`/voting/proposal/${c.ipfsHash}`),$(S("Proposal created!"))}else F(S("Error"),S("Unable to sign payload"))}catch(t){F(S("Error"),(null===t||void 0===t?void 0:t.message)||(null===t||void 0===t?void 0:t.error)),console.error(t),o(!1)}},children:Object(C.jsxs)(T.a,{children:[Object(C.jsxs)(a.m,{children:[Object(C.jsxs)(a.m,{mb:"24px",children:[Object(C.jsx)(V,{htmlFor:"name",children:S("Title")}),Object(C.jsx)(a.bb,{id:"name",name:"name",value:K,scale:"lg",onChange:e=>{const{name:t,value:n}=e.currentTarget;te(t,n)},required:!0}),ee.name&&l.name&&Object(C.jsx)(A,{errors:ee.name})]}),Object(C.jsxs)(a.m,{mb:"24px",children:[Object(C.jsx)(V,{htmlFor:"body",children:S("Content")}),Object(C.jsx)(a.Vb,{color:"textSubtle",mb:"8px",children:S("Tip: write in Markdown!")}),Object(C.jsx)(W,{id:"body",name:"body",onTextChange:e=>{te("body",e)},value:J,options:ce,required:!0}),ee.body&&l.body&&Object(C.jsx)(A,{errors:ee.body})]}),J&&Object(C.jsx)(a.m,{mb:"24px",children:Object(C.jsxs)(a.u,{children:[Object(C.jsx)(a.x,{children:Object(C.jsx)(a.V,{as:"h3",scale:"md",children:S("Preview")})}),Object(C.jsx)(a.v,{p:"0",px:"24px",children:Object(C.jsx)(v.a,{children:J})})]})}),Object(C.jsx)(Y,{choices:U,onChange:e=>{te("choices",e)}}),ee.choices&&l.choices&&Object(C.jsx)(A,{errors:ee.choices})]}),Object(C.jsx)(a.m,{children:Object(C.jsxs)(a.u,{children:[Object(C.jsx)(a.x,{children:Object(C.jsx)(a.V,{as:"h3",scale:"md",children:S("Actions")})}),Object(C.jsxs)(a.v,{children:[Object(C.jsxs)(a.m,{mb:"24px",children:[Object(C.jsx)(D,{children:S("Start Date")}),Object(C.jsx)(g.a,{name:"startDate",onChange:ne("startDate"),selected:Q,placeholderText:"YYYY/MM/DD"}),ee.startDate&&l.startDate&&Object(C.jsx)(A,{errors:ee.startDate})]}),Object(C.jsxs)(a.m,{mb:"24px",children:[Object(C.jsx)(D,{children:S("Start Time")}),Object(C.jsx)(g.c,{name:"startTime",onChange:ne("startTime"),selected:_,placeholderText:"00:00"}),ee.startTime&&l.startTime&&Object(C.jsx)(A,{errors:ee.startTime})]}),Object(C.jsxs)(a.m,{mb:"24px",children:[Object(C.jsx)(D,{children:S("End Date")}),Object(C.jsx)(g.a,{name:"endDate",onChange:ne("endDate"),selected:G,placeholderText:"YYYY/MM/DD"}),ee.endDate&&l.endDate&&Object(C.jsx)(A,{errors:ee.endDate})]}),Object(C.jsxs)(a.m,{mb:"24px",children:[Object(C.jsx)(D,{children:S("End Time")}),Object(C.jsx)(g.c,{name:"endTime",onChange:ne("endTime"),selected:X,placeholderText:"00:00"}),ee.endTime&&l.endTime&&Object(C.jsx)(A,{errors:ee.endTime})]}),P&&Object(C.jsxs)(a.T,{alignItems:"center",mb:"8px",children:[Object(C.jsx)(a.Vb,{color:"textSubtle",mr:"16px",children:S("Creator")}),Object(C.jsx)(a.fb,{href:Object(h.e)(P,"address"),children:Object(p.a)(P)})]}),Object(C.jsxs)(a.T,{alignItems:"center",mb:"16px",children:[Object(C.jsx)(a.Vb,{color:"textSubtle",mr:"16px",children:S("Snapshot")}),Object(C.jsx)(a.fb,{href:Object(h.e)(Z,"block"),children:Z})]}),P?Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(a.q,{type:"submit",width:"100%",isLoading:n,endIcon:n?Object(C.jsx)(a.g,{spin:!0,color:"currentColor"}):null,disabled:!b()(ee),mb:"16px",children:S("Publish")}),Object(C.jsxs)(a.Vb,{color:"failure",as:"p",mb:"4px",children:[S("You need at least %count% voting power to publish a proposal.",{count:N.f})," "]}),Object(C.jsx)(a.q,{scale:"sm",type:"button",variant:"text",onClick:q,p:0,children:S("Check voting power")})]}):Object(C.jsx)(y.a,{width:"100%",type:"button"})]})]})})]})})]})}},781:function(e,t,n){"use strict";n.d(t,"h",(function(){return d})),n.d(t,"c",(function(){return j})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return x})),n.d(t,"e",(function(){return h})),n.d(t,"i",(function(){return p})),n.d(t,"g",(function(){return m})),n.d(t,"a",(function(){return O})),n.d(t,"f",(function(){return f}));var c=n(12),a=n.n(c),r=n(17),s=n(89),o=n(25),i=n(50),l=n(86),b=n(783);const d=e=>e.author.toLowerCase()===b.a.toLowerCase(),j=(e,t)=>{switch(t){case i.e.COMMUNITY:return e.filter((e=>!d(e)));case i.e.CORE:return e.filter((e=>d(e)));case i.e.ALL:default:return e}},u=(e,t)=>e.filter((e=>e.state===t)),x=()=>({plugins:{},network:56,strategies:[{name:"cake",params:{symbol:"CAKE",address:Object(r.f)(),decimals:18}}]}),h=()=>({version:b.e,timestamp:(Date.now()/1e3).toFixed(),space:b.c}),p=async e=>{const t=await fetch(s.e,{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(null===e||void 0===e?void 0:e.error_description)}return await t.json()},m=async(e,t,n)=>{const c=n||await l.a.getBlockNumber(),a=await fetch(`${s.f}/power`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({address:e,block:c,poolAddresses:t})});return(await a.json()).data},O=e=>e.reduce(((e,t)=>{const n=t.proposal.choices[t.choice-1];return{...e,[n]:e[n]?[...e[n],t]:[t]}}),{}),f=e=>e.reduce(((e,t)=>{var n;const c=new a.a(null===(n=t.metadata)||void 0===n?void 0:n.votingPower);return e.plus(c)}),o.d)},783:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"f",(function(){return i}));const c=10,a="0x6eaf1b33b8672c5dc40aB8f4bA3A0111723126c7",r="https://gateway.ipfs.io/ipfs",s="0.1.3",o="cake.eth",i=10},794:function(e,t,n){"use strict";t.a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4;return`${e.substring(0,t)}...${e.substring(e.length-n)}`}},840:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));n(2);var c=n(3),a=n(4),r=n(0);const s=a.e.div`
  align-items: center;
  border: 1px solid ${e=>{let{theme:t}=e;return t.colors.cardBorder}};
  border-radius: 12px;
  display: flex;
  height: 64px;
  justify-content: space-between;
  margin-bottom: 24px;
  padding: 0 16px;
`,o=e=>Object(r.jsx)(c.m,{mb:"24px",maxWidth:"320px",...e})},853:function(e,t,n){"use strict";var c=n(59),a=n(4);const r=Object(a.e)(c.a)`
  color: ${e=>{let{theme:t}=e;return t.colors.primaryBright}};
`;t.a=r},865:function(e,t,n){"use strict";const c=n(4).e.div`
  align-items: start;
  display: grid;
  grid-gap: 32px;
  grid-template-columns: minmax(0, 1fr);

  ${e=>{let{theme:t}=e;return t.mediaQueries.lg}} {
    grid-template-columns: 1fr 332px;
  }
`;t.a=c},866:function(e,t,n){"use strict";n(2);var c=n(3),a=n(10),r=n(840),s=n(0);t.a=e=>{let{total:t,cakeBalance:n,cakeVaultBalance:o,cakePoolBalance:i,poolsBalance:l,cakeBnbLpBalance:b}=e;const{t:d}=Object(a.b)();return Object(s.jsxs)(r.a,{mb:"0",children:[Object(s.jsx)(c.Vb,{as:"p",mb:"24px",fontSize:"14px",color:"textSubtle",children:d("Your voting power is determined by the amount of CAKE you held at the block detailed below. CAKE held in other places does not contribute to your voting power.")}),Object(s.jsx)(c.Vb,{color:"secondary",textTransform:"uppercase",mb:"4px",bold:!0,fontSize:"14px",children:d("Overview")}),Object(s.jsxs)(r.b,{children:[Object(s.jsx)(c.Vb,{color:"secondary",children:d("Your Voting Power")}),Object(s.jsx)(c.Vb,{bold:!0,fontSize:"20px",children:t.toFormat(3)})]}),Object(s.jsx)(c.Vb,{color:"secondary",textTransform:"uppercase",mb:"4px",bold:!0,fontSize:"14px",children:d("Your Cake Held Now")}),Object(s.jsxs)(c.T,{alignItems:"center",justifyContent:"space-between",mb:"4px",children:[Object(s.jsx)(c.Vb,{color:"textSubtle",fontSize:"16px",children:d("Wallet")}),Object(s.jsx)(c.Vb,{textAlign:"right",children:n.toFormat(3)})]}),Object(s.jsxs)(c.T,{alignItems:"center",justifyContent:"space-between",mb:"4px",children:[Object(s.jsx)(c.Vb,{color:"textSubtle",fontSize:"16px",children:d("Manual CAKE Pool")}),Object(s.jsx)(c.Vb,{textAlign:"right",children:i.toFormat(3)})]}),Object(s.jsxs)(c.T,{alignItems:"center",justifyContent:"space-between",mb:"4px",children:[Object(s.jsx)(c.Vb,{color:"textSubtle",fontSize:"16px",children:d("Auto CAKE Pool")}),Object(s.jsx)(c.Vb,{textAlign:"right",children:o.toFormat(3)})]}),Object(s.jsxs)(c.T,{alignItems:"center",justifyContent:"space-between",mb:"4px",children:[Object(s.jsx)(c.Vb,{color:"textSubtle",fontSize:"16px",children:d("Other Syrup Pools")}),Object(s.jsx)(c.Vb,{textAlign:"right",children:l.toFormat(3)})]}),Object(s.jsxs)(c.T,{alignItems:"center",justifyContent:"space-between",mb:"4px",children:[Object(s.jsx)(c.Vb,{color:"textSubtle",fontSize:"16px",children:d("CAKE BNB LP")}),Object(s.jsx)(c.Vb,{textAlign:"right",children:b.toFormat(3)})]})]})}},867:function(e,t,n){"use strict";var c=n(2),a=n(29),r=n(25),s=n(174),o=n(17),i=n(86),l=n(12),b=n.n(l),d=n(781);const j={verificationHash:null,cakeBalance:r.d,cakeVaultBalance:r.d,cakePoolBalance:r.d,poolsBalance:r.d,cakeBnbLpBalance:r.d,total:r.d};t.a=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{account:n}=Object(a.c)(),[r,l]=Object(c.useState)(j),[u,x]=Object(c.useState)(!!n);return Object(c.useEffect)((()=>{n&&t&&(async()=>{x(!0);try{const c=e||await i.a.getBlockNumber(),a=(await Object(s.b)(c)).map((e=>{let{contractAddress:t}=e;return Object(o.a)(t)})),{cakeBalance:r,cakeBnbLpBalance:j,cakePoolBalance:u,total:h,poolsBalance:p,cakeVaultBalance:m,verificationHash:O}=await Object(d.g)(n,a,c);t&&l((e=>({...e,verificationHash:O,cakeBalance:new b.a(r),cakeBnbLpBalance:new b.a(j),cakePoolBalance:new b.a(u),poolsBalance:new b.a(p),cakeVaultBalance:new b.a(m),total:new b.a(h)})))}finally{x(!1)}})()}),[n,e,l,t,x]),{...r,isLoading:u}}},909:function(e,t,n){"use strict";n(2);var c=n(913),a=n.n(c),r=n(949),s=n.n(r),o=n(3),i=n(4),l=n(0);const b=i.e.table`
  margin-bottom: 32px;
  margin-top: 32px;
  width: 100%;

  td,
  th {
    color: ${e=>{let{theme:t}=e;return t.colors.text}};
    padding: 8px;
  }
`,d=i.e.div`
  color: ${e=>{let{theme:t}=e;return t.colors.text}};
  margin-bottom: 16px;
  margin-top: 16px;

  li {
    margin-bottom: 8px;
  }
`,j=e=>Object(l.jsx)(o.V,{as:"h4",scale:"lg",my:"16px",...e});var u={h1:j,h2:j,h3:j,h4:j,h5:j,h6:j,p:e=>Object(l.jsx)(o.Vb,{as:"p",my:"16px",...e}),table:b,ol:e=>Object(l.jsx)(d,{as:"ol",...e}),ul:e=>Object(l.jsx)(d,{as:"ul",...e}),pre:i.e.pre`
  color: ${e=>{let{theme:t}=e;return t.colors.text}};
  margin-bottom: 16px;
  margin-top: 16px;
  max-width: 100%;
  overflow-x: auto;
`};t.a=e=>Object(l.jsx)(a.a,{remarkPlugins:[s.a],components:u,...e})}}]);
//# sourceMappingURL=9.2d282341.chunk.js.map